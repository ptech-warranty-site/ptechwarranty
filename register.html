<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>P-Tech Warranty Registration</title>
  <link rel="stylesheet" href="style.css"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3.2.0/dist/email.min.js"></script>
</head>
<body>

  <body>
    <header class="site-header">
      <div class="header-top">
        <div class="logo">P-Tech Warranty</div>
        <div class="hamburger" onclick="toggleMenu()">‚ò∞</div>
      </div>
  
      <nav class="navbar" id="navbar">
        <a href="index.html">Home</a>
        <a href="warranty.html">Warranty Plan</a>
        <a href="register.html">Register Warranty</a>
        <a href="claim.html">Claim</a>
        <a href="admin.html">Admin</a>
        <a href="check.html">Warranty Checker</a>
        <a href="services.html">Services</a>
        <a href="reviews.html">Reviews</a>
        <a href="contact.html">Contact</a>
      </nav>
    </header> 
  
<body class="register-page">
<main class="container my-4">
  <h3 class="mb-3 text-center">Product Warranty Registration</h3>

  <div class="text-center mb-3">
    <a href="/warranty-form-registration.pdf" target="_blank">üìÑ Download Warranty Form (PDF)</a>
  </div>

  <div class="btn-group w-100 mb-4" role="group">
    <button type="button" class="btn btn-primary" onclick="toggleForm('online')">Online Form</button>
    <button type="button" class="btn btn-outline-primary" onclick="toggleForm('pdf')">Upload PDF</button>
  </div>

  <!-- ‚úÖ ONLINE FORM -->
  <form id="warrantyForm" class="border p-4 rounded shadow-sm" style="display: block;">
    <div class="row g-3">
      <div class="col-md-6">
        <label>First Name</label>
        <input type="text" name="firstName" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Last Name</label>
        <input type="text" name="lastName" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Email</label>
        <input type="email" name="email" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Phone</label>
        <input type="tel" name="phone" class="form-control" required>
      </div>
      <div class="col-md-12">
        <label>Street Address</label>
        <input type="text" name="address" class="form-control" required>
      </div>
      <div class="col-md-4">
        <label>City</label>
        <input type="text" name="city" class="form-control" required>
      </div>
      <div class="col-md-4">
        <label>State/Province</label>
        <input type="text" name="state" class="form-control" required>
      </div>
      <div class="col-md-4">
        <label>ZIP/Postal Code</label>
        <input type="text" name="zip" class="form-control" required>
      </div>
      <div class="col-md-12">
        <label>Country</label>
        <select name="country" class="form-select" required>
          <option value="">Select Country</option>
          <option value="KE">Kenya</option>
          <option value="UG">Uganda</option>
          <option value="TZ">Tanzania</option>
          <option value="SM">Somalia</option>
        </select>
      </div>
      <div class="col-md-6">
        <label>Product Model</label>
        <input type="text" name="productModel" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Serial Number</label>
        <input type="text" name="serialNumber" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Purchase Date</label>
        <input type="date" name="purchaseDate" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label>Purchase Location</label>
        <input type="text" name="purchaseLocation" class="form-control">
      </div>
      <div class="col-md-12">
        <label>Additional Information</label>
        <textarea name="additionalInfo" class="form-control" rows="2"></textarea>
      </div>
      <div class="col-md-12 form-check">
        <input type="checkbox" class="form-check-input" name="terms" required>
        <label class="form-check-label">I agree to the <a href="/warranty-form-registration.pdf" target="_blank">terms and conditions</a></label>
      </div>
    </div>
    <div id="submittingMessage" style="display: none; text-align:center; margin-bottom:10px;">
      <i class="fas fa-spinner fa-spin" style="color: purple;"></i> Submitting...
    </div>
    <button type="submit" class="btn btn-success mt-4 w-100">Submit Warranty Registration</button>
      </form>

  <!-- ‚úÖ PDF UPLOAD FORM -->
  <form id="pdfForm" action="https://formsubmit.co/peconnewarranty@gmail.com" method="POST" enctype="multipart/form-data" class="border p-4 rounded shadow-sm" style="display: none;">
    <input type="hidden" name="_subject" value="PDF Warranty Form Submission">
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" name="_template" value="table">

    <div class="mb-3">
      <label>Full Name</label>
      <input type="text" name="customerName" class="form-control" required>
    </div>
    <div class="mb-3">
      <label>Email</label>
      <input type="email" name="customerEmail" class="form-control" required>
    </div>
    <div class="mb-3">
      <label>Upload PDF Form</label>
      <input type="file" name="pdfAttachment" accept=".pdf" class="form-control" required>
      <small class="text-muted">Max size: 5MB</small>
    </div>
    <div class="form-check mb-3">
      <input type="checkbox" class="form-check-input" name="terms" required>
      <label class="form-check-label">I agree to the terms</label>
    </div>
    <div id="uploadingMessage" style="display: none; text-align:center; margin-bottom:10px;">
      <i class="fas fa-spinner fa-spin" style="color: red;"></i> Uploading PDF...
    </div>
    <button type="submit" class="btn btn-warning w-100">Submit PDF Form</button>
  </form>

  <!-- Messages -->
  <div id="successMessage" class="alert alert-success mt-3" style="display: none;">
    ‚úÖ Warranty registration submitted successfully.
  </div>
  <div id="errorMessage" class="alert alert-danger mt-3" style="display: none;">
    ‚ùå Submission failed. Try again.
  </div>
</main>

<!-- Firebase & JS -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBFynS9-iYS7GxTeCzq-QPi9HRJr4qIRzY",
  authDomain: "ptech-warranty-website.firebaseapp.com",
  projectId: "ptech-warranty-website",
  storageBucket: "ptech-warranty-website.appspot.com",
  messagingSenderId: "335295749830",
  appId: "1:335295749830:web:2ba5d66219eb6f04d6c1c7",
  measurementId: "G-NFKHFN19LZ"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// EmailJS Init
emailjs.init("fbVNsTIoBvJGuvFnZ");

// Elements
const onlineForm = document.getElementById("warrantyForm");
const pdfForm = document.getElementById("pdfForm");

const success = document.getElementById("successMessage");
const error = document.getElementById("errorMessage");

const submittingMessage = document.getElementById("submittingMessage");
const uploadingMessage = document.getElementById("uploadingMessage");

// Toggle Online/PDF Form
window.toggleForm = (type) => {
  onlineForm.style.display = type === "online" ? "block" : "none";
  pdfForm.style.display = type === "pdf" ? "block" : "none";
  success.style.display = "none";
  error.style.display = "none";
};

// Handle Online Form Submission
onlineForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  success.style.display = "none";
  error.style.display = "none";
  submittingMessage.style.display = "block";

  const formData = new FormData(onlineForm);
  const data = Object.fromEntries(formData.entries());
  data.timestamp = serverTimestamp();

  try {
    await addDoc(collection(db, "warranty_registrations"), data);
    await emailjs.send("service_ptech", "warranty_registration", data);

    onlineForm.reset();
    success.textContent = "‚úÖ Warranty registration submitted successfully.";
    success.style.display = "block";
  } catch (err) {
    console.error("Submit Error:", err);
    error.textContent = "‚ùå Submission failed. Try again.";
    error.style.display = "block";
  } finally {
    submittingMessage.style.display = "none";
  }
});

// Handle PDF Upload Spinner Only (FormSubmit handles actual submission)
pdfForm.addEventListener("submit", () => {
  uploadingMessage.style.display = "block";
  success.style.display = "none";
  error.style.display = "none";

  setTimeout(() => {
    uploadingMessage.style.display = "none";
  }, 3000); // Hide after 3 seconds (since it's external form)
});

// Navbar toggle
function toggleMenu() {
  const navbar = document.getElementById('navbar');
  navbar.classList.toggle('active');
}
document.querySelectorAll('.navbar a').forEach(link => {
  link.addEventListener('click', () => {
    document.getElementById('navbar').classList.remove('active');
  });
});

</script>

</body>

<footer class="site-footer">
  <div class="footer-container">

    <!-- Column 1 -->
    <div class="footer-column">
      <h3>P-Tech Warranty</h3>
      <p>Professional smartphone repair and warranty services in Mukuyu, Murang'a. We provide reliable, affordable warranty plans for students and professionals.</p><br>
      <p><i class="fas fa-map-marker-alt"></i> Mukuyu, Murang'a, Kenya</p>
      <p><i class="fas fa-phone-alt"></i> +254 704 718140 / +254 787 971161</p>
      <p><i class="fas fa-envelope"></i> peconne254@gmail.com</p>
    </div>

    <div class="footer-column">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="warranty.html">Warranty Plans</a></li>
        <li><a href="claim.html">Submit Claim</a></li>
        <li><a href="check.html">Check Warranty</a></li>
        <li><a href="services.html">Our Services</a></li>
      </ul>
    </div>

    <div class="footer-column">
      <h4>Support</h4>
      <ul>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="reviews.html">Customer Reviews</a></li>
        <li><a href="faq.html">FAQ</a></li>
        <li><a href="#">Terms & Conditions</a></li>
      </ul>
    </div>

  </div>
  <div class="footer-bottom">
    <div class="footer-socials">
      <a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a>
      <a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="#" target="_blank"><i class="fab fa-x-twitter"></i></a>
      <a href="https://wa.me/254704718140" target="_blank"><i class="fab fa-whatsapp"></i></a>
    </div>
    <p class="copyright-text">&copy; 2025 P-Tech Warranty. All Rights Reserved.</p>
  </div>       
</footer>
</html>
